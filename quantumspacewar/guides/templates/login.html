{% extends 'base.html' %}

{% block title %}ç™»å½• - é‡å­å¤ªç©ºæ€æ”»ç•¥ç«™{% endblock %}

{% block extra_css %}
<style>
    /* è¡¨å•åŠ¨ç”»æ•ˆæœ */
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .form-container {
        animation: slideIn 0.5s ease-out;
    }
    
    /* å¯†ç å¯è§æ€§åˆ‡æ¢æŒ‰é’® */
    .password-toggle {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #7f8c8d;
        transition: color 0.3s ease;
    }
    
    .password-toggle:hover {
        color: #3498db;
    }
    
    /* æŒ‰é’®æ‚¬åœæ•ˆæœå¢å¼º */
    .login-btn {
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .login-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s ease;
    }
    
    .login-btn:hover::before {
        left: 100%;
    }
    
    /* è¡¨å•å­—æ®µå®¹å™¨ */
    .form-field-container {
        position: relative;
        margin-bottom: 1.5rem;
    }
    
    /* è¡¨å•æ ‡é¢˜è£…é¥° */
    .form-title {
        position: relative;
        display: inline-block;
        margin-bottom: 2rem;
    }
    
    .form-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: linear-gradient(90deg, #3498db, #764ba2);
        border-radius: 2px;
    }
    
    /* è®°ä½å¯†ç å¤é€‰æ¡†æ ·å¼ */
    .form-check {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .form-check-input {
        width: 16px;
        height: 16px;
        accent-color: #3498db;
        cursor: pointer;
    }
    
    .form-check-label {
        cursor: pointer;
        user-select: none;
        color: #495057;
    }
    
    .form-check-input:checked + .form-check-label {
        color: #3498db;
    }
</style>
{% endblock %}

{% block page_header %}
<div style="text-align: center; margin-bottom: 2rem;">
    <h1>æ¬¢è¿å›åˆ°é‡å­å¤ªç©ºæ€æ”»ç•¥ç«™</h1>
    <p>ç™»å½•ä½ çš„è´¦å·ï¼Œç»§ç»­ä½ çš„æ¸¸æˆæ”»ç•¥ä¹‹æ—…</p>
</div>
{% endblock %}

{% block content %}
<div class="form-container" style="max-width: 450px; margin: 0 auto;">
    <div class="card" style="background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px);">
        <h2 class="form-title" style="text-align: center; margin-bottom: 2.5rem;">ç”¨æˆ·ç™»å½•</h2>
        
        <form method="post" id="loginForm">
            {% csrf_token %}
            
            {% if form.non_field_errors %}
                <div class="error" style="margin-bottom: 1.5rem; padding: 0.75rem; border-radius: var(--border-radius);">
                    {{ form.non_field_errors }}
                </div>
            {% endif %}
            
            <div class="form-field-container">
                <label for="{{ form.username.id_for_label }}" class="form-label">{{ form.username.label }}</label>
                {{ form.username }}
                {% if form.username.errors %}
                    <div class="error">{{ form.username.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field-container">
                <label for="{{ form.password.id_for_label }}" class="form-label">{{ form.password.label }}</label>
                <div style="position: relative;">
                    {{ form.password }}
                    <span class="password-toggle" onclick="togglePasswordVisibility('{{ form.password.id_for_label }}')">ğŸ‘ï¸</span>
                </div>
                {% if form.password.errors %}
                    <div class="error">{{ form.password.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field-container">
                <div class="form-check" style="margin-bottom: 0.5rem;">
                    {{ form.remember_me }}
                    <label class="form-check-label" for="{{ form.remember_me.id_for_label }}" style="font-size: 0.9rem;">
                        {{ form.remember_me.label }}
                    </label>
                </div>
                {% if form.remember_me.errors %}
                    <div class="error">{{ form.remember_me.errors }}</div>
                {% endif %}
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <a href="#" style="color: #3498db; text-decoration: none; font-size: 0.9rem;">å¿˜è®°å¯†ç ï¼Ÿ</a>
            </div>
            
            <button type="submit" class="btn btn-primary login-btn" style="width: 100%; padding: 0.75rem; font-size: 1rem;">
                <span>ç™»å½•</span>
            </button>
        </form>
        
        <div style="text-align: center; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #eee;">
            <p style="margin-bottom: 0;">
                è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ <a href="{% url 'guides:register' %}" style="color: #3498db; text-decoration: none; font-weight: 500;">ç«‹å³æ³¨å†Œ</a>
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // è¡¨å•æäº¤æ—¶çš„åŠ è½½æ•ˆæœ
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        const submitBtn = this.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<div class="loading"></div> ç™»å½•ä¸­...';
        
        // æ¨¡æ‹Ÿè¡¨å•æäº¤å»¶è¿Ÿ
        setTimeout(function() {
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;
        }, 2000);
    });
    
    // å¯†ç å¯è§æ€§åˆ‡æ¢åŠŸèƒ½
    function togglePasswordVisibility(passwordInputId) {
        const passwordInput = document.getElementById(passwordInputId);
        const passwordToggle = passwordInput.nextElementSibling;
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            passwordToggle.textContent = 'ğŸ‘ï¸â€ğŸ—¨ï¸';
        } else {
            passwordInput.type = 'password';
            passwordToggle.textContent = 'ğŸ‘ï¸';
        }
    }
    
    // è¡¨å•è¾“å…¥éªŒè¯å’Œåé¦ˆ
    document.querySelectorAll('.form-control').forEach(input => {
        input.addEventListener('input', function() {
            // æ¸…é™¤æ‰€æœ‰é”™è¯¯æ¶ˆæ¯
            document.querySelectorAll('.error').forEach(error => {
                error.style.display = 'none';
            });
            
            // æ·»åŠ è¾“å…¥åŠ¨ç”»æ•ˆæœ
            this.style.transform = 'scale(1.02)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 200);
        });
    });
</script>
{% endblock %}
{% extends 'base.html' %}

{% block title %}æ³¨å†Œ - é‡å­å¤ªç©ºæ€æ”»ç•¥ç«™{% endblock %}

{% block extra_css %}
<style>
    /* è¡¨å•åŠ¨ç”»æ•ˆæœ */
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .form-container {
        animation: slideIn 0.5s ease-out;
    }
    
    /* è¾“å…¥æ¡†èšç„¦æ•ˆæœ */
    .form-control:focus {
        border-color: #3498db;
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    /* å¯†ç å¯è§æ€§åˆ‡æ¢æŒ‰é’® */
    .password-toggle {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #7f8c8d;
        transition: color 0.3s ease;
    }
    
    .password-toggle:hover {
        color: #3498db;
    }
    
    /* æŒ‰é’®æ‚¬åœæ•ˆæœå¢å¼º */
    .register-btn {
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .register-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s ease;
    }
    
    .register-btn:hover::before {
        left: 100%;
    }
    
    /* è¡¨å•å­—æ®µå®¹å™¨ */
    .form-field-container {
        position: relative;
        margin-bottom: 1.5rem;
    }
    
    /* è¾“å…¥æç¤ºä¿¡æ¯ */
    .input-hint {
        font-size: 0.85rem;
        color: #7f8c8d;
        margin-top: 0.25rem;
    }
    
    /* è¡¨å•æ ‡é¢˜è£…é¥° */
    .form-title {
        position: relative;
        display: inline-block;
        margin-bottom: 2rem;
    }
    
    .form-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: linear-gradient(90deg, #3498db, #764ba2);
        border-radius: 2px;
    }
</style>
{% endblock %}

{% block page_header %}
<div style="text-align: center; margin-bottom: 2rem;">
    <h1>åŠ å…¥é‡å­å¤ªç©ºæ€æ”»ç•¥ç¤¾åŒº</h1>
    <p>åˆ›å»ºè´¦å·ï¼Œå¼€å§‹åˆ†äº«ä½ çš„æ¸¸æˆæ”»ç•¥å’ŒæŠ€å·§</p>
</div>
{% endblock %}

{% block content %}
<div class="form-container" style="max-width: 500px; margin: 0 auto;">
    <div class="card" style="background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px);">
        <h2 class="form-title" style="text-align: center; margin-bottom: 2.5rem;">åˆ›å»ºè´¦å·</h2>
        
        <form method="post" id="registerForm">
            {% csrf_token %}
            
            <div class="form-field-container">
                <label for="{{ form.username.id_for_label }}" class="form-label">{{ form.username.label }}</label>
                {{ form.username }}
                <div class="input-hint">ç”¨æˆ·åé•¿åº¦ä¸º3-30ä¸ªå­—ç¬¦</div>
                {% if form.username.errors %}
                    <div class="error">{{ form.username.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field-container">
                <label for="{{ form.email.id_for_label }}" class="form-label">{{ form.email.label }}</label>
                {{ form.email }}
                <div class="input-hint">è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€</div>
                {% if form.email.errors %}
                    <div class="error">{{ form.email.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field-container">
                <label for="{{ form.password.id_for_label }}" class="form-label">{{ form.password.label }}</label>
                <div style="position: relative;">
                    {{ form.password }}
                    <span class="password-toggle" onclick="togglePasswordVisibility('{{ form.password.id_for_label }}')">ğŸ‘ï¸</span>
                </div>
                <div class="input-hint">å¯†ç è‡³å°‘åŒ…å«8ä¸ªå­—ç¬¦ï¼Œå»ºè®®ä½¿ç”¨å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·</div>
                {% if form.password.errors %}
                    <div class="error">{{ form.password.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field-container">
                <label for="{{ form.confirm_password.id_for_label }}" class="form-label">{{ form.confirm_password.label }}</label>
                <div style="position: relative;">
                    {{ form.confirm_password }}
                    <span class="password-toggle" onclick="togglePasswordVisibility('{{ form.confirm_password.id_for_label }}')">ğŸ‘ï¸</span>
                </div>
                {% if form.confirm_password.errors %}
                    <div class="error">{{ form.confirm_password.errors }}</div>
                {% endif %}
            </div>
            
            <button type="submit" class="btn btn-primary register-btn" style="width: 100%; padding: 0.75rem; font-size: 1rem;">
                <span>ç«‹å³æ³¨å†Œ</span>
            </button>
        </form>
        
        <div style="text-align: center; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #eee;">
            <p style="margin-bottom: 0;">
                å·²æœ‰è´¦å·ï¼Ÿ <a href="{% url 'guides:login' %}" style="color: #3498db; text-decoration: none; font-weight: 500;">ç«‹å³ç™»å½•</a>
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // è¡¨å•æäº¤æ—¶çš„åŠ è½½æ•ˆæœ
    document.getElementById('registerForm').addEventListener('submit', function(e) {
        const submitBtn = this.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<div class="loading"></div> æ³¨å†Œä¸­...';
        
        // æ¨¡æ‹Ÿè¡¨å•æäº¤å»¶è¿Ÿï¼Œå®é™…æƒ…å†µä¸‹ä¼šåœ¨æœåŠ¡å™¨å“åº”åè‡ªç„¶å¤„ç†
        setTimeout(function() {
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;
        }, 2000);
    });
    
    // å¯†ç å¯è§æ€§åˆ‡æ¢åŠŸèƒ½
    function togglePasswordVisibility(passwordInputId) {
        const passwordInput = document.getElementById(passwordInputId);
        const passwordToggle = passwordInput.nextElementSibling;
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            passwordToggle.textContent = 'ğŸ‘ï¸â€ğŸ—¨ï¸';
        } else {
            passwordInput.type = 'password';
            passwordToggle.textContent = 'ğŸ‘ï¸';
        }
    }
    
    // è¡¨å•è¾“å…¥éªŒè¯å’Œåé¦ˆ
    document.querySelectorAll('.form-control').forEach(input => {
        input.addEventListener('input', function() {
            const errorDiv = this.parentElement.nextElementSibling;
            if (errorDiv && errorDiv.classList.contains('error')) {
                errorDiv.style.display = 'none';
            }
            
            // æ·»åŠ è¾“å…¥åŠ¨ç”»æ•ˆæœ
            this.style.transform = 'scale(1.02)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 200);
        });
    });
</script>
{% endblock %}